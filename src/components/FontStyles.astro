---
// FontStyles component - Auto-generates font declarations from FONTS config
import { FONTS } from '@/consts'

const fonts = Object.values(FONTS)
const defaultFont = fonts.find((f) => f.default) || fonts[0]
if (!defaultFont) {
  throw new Error('No fonts configured in FONTS constant')
}

// Get base URL for font paths
const baseUrl = import.meta.env.BASE_URL
---

<style
  is:global
  set:html={`
  /* Auto-generated @font-face rules */
  ${fonts
    .map((font) => {
      const fontPath = font.file.startsWith('/')
        ? font.file.slice(1)
        : font.file
      const fullPath = baseUrl.endsWith('/')
        ? `${baseUrl}${fontPath}`
        : `${baseUrl}/${fontPath}`
      return `
    @font-face {
      font-family: '${font.cssName}';
      src: url('${fullPath}') format('${font.format}');
      font-weight: ${font.variable ? '100 900' : 'normal'};
      font-style: normal;
      font-display: optional;
    }
  `
    })
    .join('\n')}

  /* Font switching CSS custom properties */
  :root,
  [data-font='${defaultFont.id}'] {
    --font-sans: '${defaultFont.cssName}', ${defaultFont.fallback};
  }

  ${fonts
    .filter((f) => !f.default)
    .map(
      (font) => `
    [data-font='${font.id}'] {
      --font-sans: '${font.cssName}', ${font.fallback};
    }
  `,
    )
    .join('\n')}
`}
></style>
